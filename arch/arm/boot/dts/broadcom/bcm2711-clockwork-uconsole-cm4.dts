// SPDX-License-Identifier: GPL-2.0
/dts-v1/;
#include "bcm2711-rpi-cm4.dtsi"
#include "bcm283x-rpi-usb-host.dtsi"

/ {
	model = "Clockworkpi uConsole ";

	ocp8178_backlight: backlight@0 {
		compatible = "ocs,ocp8178";
		backlight-control-gpios = <&gpio 9 0>;
		default-brightness = <5>;
	};

	battery: battery@0 {
		compatible = "simple-battery";
		constant_charge_current_max_microamp = <2100000>;
		voltage-min-design-microvolt = <3300000>;
	};
};

&ddc0 {
	status = "okay";
};

&ddc1 {
	status = "okay";
};

&hdmi0 {
	status = "okay";
};

&hdmi1 {
	status = "okay";
};

&pixelvalve0 {
	status = "okay";
};

&pixelvalve1 {
	status = "okay";
};

&pixelvalve2 {
	status = "okay";
};

&pixelvalve4 {
	status = "okay";
};

&vc4 {
	status = "okay";
};

&vec {
	status = "disabled";
};

&dsi1 {
  status = "okay";
	port {
		dsi_out_port: endpoint {
			remote-endpoint = <&panel_dsi_port>;
		};
	};

	panel_cwu50: panel@0 {
		compatible = "clockwork,cwu50";
		reg = <0>;
		reset-gpio = <&gpio 8 1>;
		backlight = <&ocp8178_backlight>;
		rotation = <90>;

		port {
			panel_dsi_port: endpoint {
				remote-endpoint = <&dsi_out_port>;
			};
		};
	};
};

&i2c0 {
	axp22x: pmic@34 {
		interrupt-controller;
		#interrupt-cells = <1>;
		compatible = "x-powers,axp223";
		reg = <0x34>; /* i2c address */
		interrupt-parent = <&gpio>;
		interrupts = <2 8>;  /* IRQ_TYPE_EDGE_FALLING */
		irq-gpios = <&gpio 2 0>;

		regulators {

			x-powers,dcdc-freq = <3000>;

			reg_aldo1: aldo1 {
				regulator-always-on;
				regulator-min-microvolt = <3300000>;
				regulator-max-microvolt = <3300000>;
				regulator-name = "audio-vdd";
			};

			reg_aldo2: aldo2 {
				regulator-always-on;
				regulator-min-microvolt = <3300000>;
				regulator-max-microvolt = <3300000>;
				regulator-name = "display-vcc";
			};

			reg_dldo2: dldo2 {
				regulator-always-on;
				regulator-min-microvolt = <3300000>;
				regulator-max-microvolt = <3300000>;
				regulator-name = "dldo2";
			};

			reg_dldo3: dldo3 {
				regulator-always-on;
				regulator-min-microvolt = <3300000>;
				regulator-max-microvolt = <3300000>;
				regulator-name = "dldo3";
			};

			reg_dldo4: dldo4 {
				regulator-always-on;
				regulator-min-microvolt = <3300000>;
				regulator-max-microvolt = <3300000>;
				regulator-name = "dldo4";
			};

		};

		battery_power_supply: battery-power-supply {
			compatible = "x-powers,axp221-battery-power-supply";
			monitored-battery = <&battery>;
		};

		ac_power_supply: ac_power_supply {
			compatible = "x-powers,axp221-ac-power-supply";
		};

	};
};
